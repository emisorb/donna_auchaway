#!/usr/bin/env ruby

# Cargar librerías y entornos.
require 'bundler'
require 'yaml'
entorno = ENV['DONNA_ENV'] || :development
Bundler.require(:default, entorno)

# Cargar punto de inicio
require_relative '../lib/donna'

c = Donna::Config.new

# TODO, Cambiar esta inicialización para que funcione a la vez en discord y telegram.
begin
  if c.telegram['key'].nil?
    raise ArgumentError.new('Falta configurar la API Key')
  else
    Telegram::Bot.configure do |config|
      config.adapter = :net_http_persistent
    end
  end

  # Hey! Listen!
  Donna::Bot.new(c).run!
rescue ArgumentError, Telegram::Bot::Exceptions::ResponseError => e
  # TODO, Logger?
  pp e
end
